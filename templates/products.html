<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../static/css/style.css">
</head>
<body>
    <nav class="navbar">
        <ul class="navbar-nav">
            <li><a href="index.html"><d1>Logout</d1></a></li>
            <li><a href="#"><img src="../static/images/avatar.png" alt="" class="avatar-favicon"><d1>Hello Aretha</d1></a></li>

        </ul>
    </nav>
    <div id="side-menu" class="side-nav">

        <a href="categories.html" ><img src="../static/images/home.png" alt="" class="favicon"> <span id="side-menu-link">Categories</span></a>
        <br>
        <a href="products.html" class="active"><img src="../static/images/inventory.png" alt="" class="favicon"><span id="side-menu-link4">Products</span></a>
        <br>
        <a href="sales.html" ><img src="../static/images/reports.png" alt="" class="favicon"><span id="side-menu-link3">Sales</span></a>
    </div>

    <div id="main">
        <span class="navbartoggle opened" id="open-slide" style="font-size:30px;cursor:pointer;margin-top:-80px;position:absolute;">
            &#9776;
        </span>
        <div id="main">


        <label id="report-label">Products Available</label>
        <br>
        <input type="text" id="myInput"  placeholder="Filter inventory.">
        <div id="table-container">
            <table>
              <thead>
             <tr>
                  <th>Shop attendant</th>
                  <th>Product Sold</th>
                  <th>Price Per Unit</th>
                  <th>quantity Sold</th>
                  <th>Total Price</th>
                </tr>
              </thead>
            </table>
        <div id="output"></div>
        <div class="admin-btn">

            <input type="submit" value="Delete" class="btn-btn-submit">
            <a href="add-item.html"><input type="submit" value="Add" class="btn-btn-submit"></a>
            <a href="edit-item.html"><input type="submit" value="Edit" class="btn-btn-submit"></a>
            <input type="submit" value="Get Products" id="getText" class="btn-btn-submit">
        </div>
        </div>
    </div>
    </div>

    <nav class="navbar-bottom">
            <h2>Store Manager Â© 2018 . All Rights Reserved.</h2>
    </nav>
    <script src="../static/js/myscript.js"></script>
    <script>
        document.getElementById('getText').addEventListener('click', getProducts);
        function getProducts(){
            fetch('http://127.0.0.1:5000/api/v1/products',{
                method: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + localStorage.getItem("access_token"),
                    'Accept': 'application/json, text/plain, */*',
                    'Content-type': 'application/json'
                }
            })

                .then((res) => res.json())
                    //console.log(res.json());
                .then((data) => {
                    console.log(data);

                    if("msg" in data){
                        alert(data.msg)
                    }
                    if ("message" in data){
                        alert(data.message)
                    } else {
                        let output = '<h2> </h2>';
                        data.forEach(function (product) {
                            output += `
                        <table>
                        <tbody>
                        <tr >
                        <td><input type="radio"></td>
                        <td class = "list-group-item">${product.product_name}</td>
                        <td class = "list-group-item">${product.unit_price}</td>
                        <td class = "list-group-item">${product.stock}</td>
                        <td class = "list-group-item">${product.category_name}</td>
                        </tr>
                        </tbody>
                        </table>
                        `;
                        });


                        document.getElementById('output').innerHTML = output;
                    }

                })

        }
    </script>
</body>
</html>